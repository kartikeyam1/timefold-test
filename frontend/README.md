# 🗺️ Timefold Slot Optimizer - Frontend Visualization

Interactive web-based visualization for the Timefold Slot Optimizer results. View orders, assignments, and rider utilization on an interactive map with detailed statistics.

## ✨ Features

### 📊 **Input Visualization**
- **Order Mapping**: All orders displayed on an interactive map
- **Color Coding**: Orders colored by flexibility (single day vs multi-day windows)
- **Detailed Popups**: Hover over orders to see:
  - Weight and volume
  - Required skills
  - Time window preferences
  - Allowed days
- **Statistics Dashboard**: Order distribution, skills analysis, and day-wise breakdowns

### 🎯 **Output Visualization**
- **Rider Clusters**: Each rider shown as a depot with assigned orders
- **Assignment Lines**: Visual connections between riders and their orders
- **Utilization Color Coding**:
  - 🟢 Green: Low utilization (<60%)
  - 🟠 Orange: Medium utilization (60-85%)
  - 🔴 Red: High utilization (>85%)
- **Interactive Popups**: Click on riders or orders for detailed info
- **Performance Metrics**: Daily summaries and utilization charts

### 🔧 **Controls**
- **Version Selection**: Switch between different solver runs (v1, v2, prod, test)
- **View Toggle**: Switch between Input and Output views
- **Day Filtering**: Filter by specific days or view all days
- **Real-time Updates**: Refresh visualization as new data becomes available

## 🚀 Quick Start

### 1. Generate Data
First, make sure you have CSV data from the solver:
```bash
# Run the solver to generate CSV files
mvn exec:java -Dexec.mainClass="com.example.slot.App"
```

### 2. Start the Server
```bash
# Start the web server
cd frontend
python3 server.py
```

### 3. Open Browser
Navigate to: **http://localhost:8080/frontend/**

### 4. Load Data
1. Select your version (v1, v2, etc.)
2. Click "Load Data"
3. Switch between Input/Output views
4. Use day filters to focus on specific days

## 📁 File Structure

```
frontend/
├── index.html          # Main HTML interface
├── app.js             # JavaScript application logic
├── server.py          # Python HTTP server with CORS
└── README.md          # This file

csv_output/            # CSV data directory (generated by solver)
├── v1/
│   ├── input_orders.csv
│   ├── input_riders.csv
│   ├── output_assignments.csv
│   ├── output_shift_summary.csv
│   └── output_daily_summary.csv
└── v2/ (etc.)
```

## 🎨 Technology Stack

- **Frontend**: Vanilla HTML/CSS/JavaScript (no framework dependencies)
- **Mapping**: Leaflet.js for interactive maps
- **Charts**: Chart.js for statistics visualization
- **CSV Parsing**: Papa Parse for client-side CSV reading
- **Server**: Python HTTP server with CORS support

## 📊 Data Visualization

### Input View
- **Map Markers**: Orders positioned by lat/lng coordinates
- **Color Scheme**: Based on order flexibility (allowed days)
- **Popup Information**: Complete order details
- **Statistics**: Order counts, skills distribution, day analysis

### Output View
- **Rider Depots**: Positioned at rider starting locations
- **Order Clusters**: Orders grouped by assigned rider
- **Connection Lines**: Dashed lines from riders to assigned orders
- **Utilization Metrics**: Color-coded efficiency indicators

## 🔧 Customization

### Adding New Versions
Simply change the version in the solver:
```java
// In App.java
private static final String RUN_VERSION = "your_version";
```

### Color Schemes
Modify colors in `app.js`:
```javascript
const COLORS = {
    days: ['#e74c3c', '#f39c12', ...],
    utilization: {
        low: '#27ae60',
        medium: '#f39c12', 
        high: '#e74c3c'
    }
};
```

### Map Center
Change the default map center in `app.js`:
```javascript
map = L.map('map').setView([lat, lng], zoom);
```

## 🐛 Troubleshooting

### "Failed to load data" Error
- Ensure CSV files exist in `csv_output/[version]/`
- Check that the solver has been run successfully
- Verify the server is running from the correct directory

### CORS Issues
- Use the provided Python server instead of opening HTML directly
- The server automatically handles CORS for CSV file access

### Performance with Large Datasets
- Use day filtering for better performance with 5000+ orders
- Consider reducing marker density for very large datasets

## 📈 Future Enhancements

- [ ] Real-time solver progress updates
- [ ] Export visualization as images/PDFs
- [ ] Advanced filtering options (by skills, weight, etc.)
- [ ] Side-by-side version comparison
- [ ] 3D visualization for complex scenarios
- [ ] Mobile-responsive design improvements

## 🤝 Contributing

The frontend is designed to be framework-agnostic and easily extensible. Feel free to:
- Add new chart types
- Implement additional filters
- Enhance the visual design
- Add export capabilities

---

**📍 Map Data**: © OpenStreetMap contributors  
**🎯 Optimization**: Powered by Timefold Solver
